{
  "hash": "1e936e273c9e10ccafd3007250ff912f",
  "result": {
    "markdown": "---\ntitle: Chaining Prompts\ntitle-slide-attributes:\n  data-background-image: ../images/logo.png\n  data-background-size: contain\n  data-background-opacity: \"0.5\"\nlang: en\nsubtitle: Tutorial 5\nauthor: Jan Kirenz\nexecute:\n  eval: true\n  echo: true\nhighlight-style: github\nformat:\n  revealjs: \n    toc: true\n    toc-depth: 1\n    embed-resources: false\n    theme: [dark, ../custom.scss]  \n    incremental: true\n    transition: slide\n    background-transition: fade\n    transition-speed: slow\n    code-copy: true\n    code-line-numbers: true\n    smaller: false\n    scrollable: true\n    slide-number: c\n    preview-links: auto\n    chalkboard: \n      buttons: false\n   # logo: ../images/logo.png\n    footer: Jan Kirenz\n---\n\n# Setup\n\n## Python\n\n::: {#7d2fd1fe .cell execution_count=1}\n``` {.python .cell-code}\nimport json\nimport os\nimport openai\nfrom dotenv import load_dotenv, find_dotenv\n_ = load_dotenv(find_dotenv())  # read local .env file\n\nopenai.api_key = os.environ['OPENAI_API_KEY']\n```\n:::\n\n\n## Helper function\n\n::: {#5e721945 .cell execution_count=2}\n``` {.python .cell-code}\ndef get_completion_from_messages(messages,\n                                 model=\"gpt-3.5-turbo\",\n                                 temperature=0,\n                                 max_tokens=500):\n    response = openai.ChatCompletion.create(\n        model=model,\n        messages=messages,\n        temperature=temperature,\n        max_tokens=max_tokens,\n    )\n    return response.choices[0].message[\"content\"]\n\n```\n:::\n\n\n# Multiple Prompts\n\nImplement a complex task with multiple prompts\n\n## System message {.smaller}\n\nExtract relevant product and category names\n\n::: {#25c664c1 .cell execution_count=3}\n``` {.python .cell-code}\ndelimiter = \"####\"\n\nsystem_message = f\"\"\"\nYou will be provided with customer service queries. \\\nThe customer service query will be delimited with \\\n{delimiter} characters.\nOutput a python list of objects, where each object has \\\nthe following format:\n    'category': <one of Computers and Laptops, \\\n    Smartphones and Accessories, \\\n    Televisions and Home Theater Systems, \\\n    Gaming Consoles and Accessories, \n    Audio Equipment, Cameras and Camcorders>,\nOR\n    'products': <a list of products that must \\\n    be found in the allowed products below>\n\nWhere the categories and products must be found in \\\nthe customer service query.\nIf a product is mentioned, it must be associated with \\\nthe correct category in the allowed products list below.\nIf no products or categories are found, output an \\\nempty list.\n\nAllowed products: \n\nComputers and Laptops category:\nTechPro Ultrabook\nBlueWave Gaming Laptop\nPowerLite Convertible\nTechPro Desktop\nBlueWave Chromebook\n\nSmartphones and Accessories category:\nSmartX ProPhone\nMobiTech PowerCase\nSmartX MiniPhone\nMobiTech Wireless Charger\nSmartX EarBuds\n\nTelevisions and Home Theater Systems category:\nCineView 4K TV\nSoundMax Home Theater\nCineView 8K TV\nSoundMax Soundbar\nCineView OLED TV\n\nGaming Consoles and Accessories category:\nGameSphere X\nProGamer Controller\nGameSphere Y\nProGamer Racing Wheel\nGameSphere VR Headset\n\nAudio Equipment category:\nAudioPhonic Noise-Canceling Headphones\nWaveSound Bluetooth Speaker\nAudioPhonic True Wireless Earbuds\nWaveSound Soundbar\nAudioPhonic Turntable\n\nCameras and Camcorders category:\nFotoSnap DSLR Camera\nActionCam 4K\nFotoSnap Mirrorless Camera\nZoomMaster Camcorder\nFotoSnap Instant Camera\n\nOnly output the list of objects, with nothing else.\n\"\"\"\n\n```\n:::\n\n\n## User message 1\n\n::: {#ddd44e0b .cell execution_count=4}\n``` {.python .cell-code}\nuser_message_1 = f\"\"\"\n tell me about the smartx pro phone and \\\n the fotosnap camera, the dslr one. \\\n Also tell me about your tvs \"\"\"\n```\n:::\n\n\n## Messages\n\n::: {#f617da50 .cell execution_count=5}\n``` {.python .cell-code}\nmessages = [\n    {'role': 'system',\n     'content': system_message},\n    {'role': 'user',\n     'content': f\"{delimiter}{user_message_1}{delimiter}\"},\n]\n```\n:::\n\n\n## Response\n\n::: {#16d83090 .cell output-location='fragment' execution_count=6}\n``` {.python .cell-code}\ncategory_and_product_response_1 = get_completion_from_messages(messages)\nprint(category_and_product_response_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[{'category': 'Smartphones and Accessories'}, {'category': 'Cameras and Camcorders'}, {'category': 'Televisions and Home Theater Systems'}]\n```\n:::\n:::\n\n\n## User message 2\n\n::: {#b2cc6a7e .cell execution_count=7}\n``` {.python .cell-code}\nuser_message_2 = f\"\"\"\nmy router isn't working\"\"\"\n```\n:::\n\n\n## Messages\n\n::: {#77c38d8c .cell execution_count=8}\n``` {.python .cell-code}\nmessages = [\n    {'role': 'system',\n     'content': system_message},\n    {'role': 'user',\n     'content': f\"{delimiter}{user_message_2}{delimiter}\"},\n]\n```\n:::\n\n\n## Response\n\n::: {#7994cb8c .cell output-location='fragment' execution_count=9}\n``` {.python .cell-code}\nresponse = get_completion_from_messages(messages)\nprint(response)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[]\n```\n:::\n:::\n\n\n# Detailed Product Information\n\nRetrieve detailed product information for extracted products and categories\n\n## Product information {.smaller}\n\n::: {#b89f90e1 .cell execution_count=10}\n``` {.python .cell-code}\n# product information\nproducts = {\n    \"TechPro Ultrabook\": {\n        \"name\": \"TechPro Ultrabook\",\n        \"category\": \"Computers and Laptops\",\n        \"brand\": \"TechPro\",\n        \"model_number\": \"TP-UB100\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.5,\n        \"features\": [\"13.3-inch display\", \"8GB RAM\", \"256GB SSD\", \"Intel Core i5 processor\"],\n        \"description\": \"A sleek and lightweight ultrabook for everyday use.\",\n        \"price\": 799.99\n    },\n    \"BlueWave Gaming Laptop\": {\n        \"name\": \"BlueWave Gaming Laptop\",\n        \"category\": \"Computers and Laptops\",\n        \"brand\": \"BlueWave\",\n        \"model_number\": \"BW-GL200\",\n        \"warranty\": \"2 years\",\n        \"rating\": 4.7,\n        \"features\": [\"15.6-inch display\", \"16GB RAM\", \"512GB SSD\", \"NVIDIA GeForce RTX 3060\"],\n        \"description\": \"A high-performance gaming laptop for an immersive experience.\",\n        \"price\": 1199.99\n    },\n    \"PowerLite Convertible\": {\n        \"name\": \"PowerLite Convertible\",\n        \"category\": \"Computers and Laptops\",\n        \"brand\": \"PowerLite\",\n        \"model_number\": \"PL-CV300\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.3,\n        \"features\": [\"14-inch touchscreen\", \"8GB RAM\", \"256GB SSD\", \"360-degree hinge\"],\n        \"description\": \"A versatile convertible laptop with a responsive touchscreen.\",\n        \"price\": 699.99\n    },\n    \"TechPro Desktop\": {\n        \"name\": \"TechPro Desktop\",\n        \"category\": \"Computers and Laptops\",\n        \"brand\": \"TechPro\",\n        \"model_number\": \"TP-DT500\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.4,\n        \"features\": [\"Intel Core i7 processor\", \"16GB RAM\", \"1TB HDD\", \"NVIDIA GeForce GTX 1660\"],\n        \"description\": \"A powerful desktop computer for work and play.\",\n        \"price\": 999.99\n    },\n    \"BlueWave Chromebook\": {\n        \"name\": \"BlueWave Chromebook\",\n        \"category\": \"Computers and Laptops\",\n        \"brand\": \"BlueWave\",\n        \"model_number\": \"BW-CB100\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.1,\n        \"features\": [\"11.6-inch display\", \"4GB RAM\", \"32GB eMMC\", \"Chrome OS\"],\n        \"description\": \"A compact and affordable Chromebook for everyday tasks.\",\n        \"price\": 249.99\n    },\n    \"SmartX ProPhone\": {\n        \"name\": \"SmartX ProPhone\",\n        \"category\": \"Smartphones and Accessories\",\n        \"brand\": \"SmartX\",\n        \"model_number\": \"SX-PP10\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.6,\n        \"features\": [\"6.1-inch display\", \"128GB storage\", \"12MP dual camera\", \"5G\"],\n        \"description\": \"A powerful smartphone with advanced camera features.\",\n        \"price\": 899.99\n    },\n    \"MobiTech PowerCase\": {\n        \"name\": \"MobiTech PowerCase\",\n        \"category\": \"Smartphones and Accessories\",\n        \"brand\": \"MobiTech\",\n        \"model_number\": \"MT-PC20\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.3,\n        \"features\": [\"5000mAh battery\", \"Wireless charging\", \"Compatible with SmartX ProPhone\"],\n        \"description\": \"A protective case with built-in battery for extended usage.\",\n        \"price\": 59.99\n    },\n    \"SmartX MiniPhone\": {\n        \"name\": \"SmartX MiniPhone\",\n        \"category\": \"Smartphones and Accessories\",\n        \"brand\": \"SmartX\",\n        \"model_number\": \"SX-MP5\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.2,\n        \"features\": [\"4.7-inch display\", \"64GB storage\", \"8MP camera\", \"4G\"],\n        \"description\": \"A compact and affordable smartphone for basic tasks.\",\n        \"price\": 399.99\n    },\n    \"MobiTech Wireless Charger\": {\n        \"name\": \"MobiTech Wireless Charger\",\n        \"category\": \"Smartphones and Accessories\",\n        \"brand\": \"MobiTech\",\n        \"model_number\": \"MT-WC10\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.5,\n        \"features\": [\"10W fast charging\", \"Qi-compatible\", \"LED indicator\", \"Compact design\"],\n        \"description\": \"A convenient wireless charger for a clutter-free workspace.\",\n        \"price\": 29.99\n    },\n    \"SmartX EarBuds\": {\n        \"name\": \"SmartX EarBuds\",\n        \"category\": \"Smartphones and Accessories\",\n        \"brand\": \"SmartX\",\n        \"model_number\": \"SX-EB20\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.4,\n        \"features\": [\"True wireless\", \"Bluetooth 5.0\", \"Touch controls\", \"24-hour battery life\"],\n        \"description\": \"Experience true wireless freedom with these comfortable earbuds.\",\n        \"price\": 99.99\n    },\n\n    \"CineView 4K TV\": {\n        \"name\": \"CineView 4K TV\",\n        \"category\": \"Televisions and Home Theater Systems\",\n        \"brand\": \"CineView\",\n        \"model_number\": \"CV-4K55\",\n        \"warranty\": \"2 years\",\n        \"rating\": 4.8,\n        \"features\": [\"55-inch display\", \"4K resolution\", \"HDR\", \"Smart TV\"],\n        \"description\": \"A stunning 4K TV with vibrant colors and smart features.\",\n        \"price\": 599.99\n    },\n    \"SoundMax Home Theater\": {\n        \"name\": \"SoundMax Home Theater\",\n        \"category\": \"Televisions and Home Theater Systems\",\n        \"brand\": \"SoundMax\",\n        \"model_number\": \"SM-HT100\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.4,\n        \"features\": [\"5.1 channel\", \"1000W output\", \"Wireless subwoofer\", \"Bluetooth\"],\n        \"description\": \"A powerful home theater system for an immersive audio experience.\",\n        \"price\": 399.99\n    },\n    \"CineView 8K TV\": {\n        \"name\": \"CineView 8K TV\",\n        \"category\": \"Televisions and Home Theater Systems\",\n        \"brand\": \"CineView\",\n        \"model_number\": \"CV-8K65\",\n        \"warranty\": \"2 years\",\n        \"rating\": 4.9,\n        \"features\": [\"65-inch display\", \"8K resolution\", \"HDR\", \"Smart TV\"],\n        \"description\": \"Experience the future of television with this stunning 8K TV.\",\n        \"price\": 2999.99\n    },\n    \"SoundMax Soundbar\": {\n        \"name\": \"SoundMax Soundbar\",\n        \"category\": \"Televisions and Home Theater Systems\",\n        \"brand\": \"SoundMax\",\n        \"model_number\": \"SM-SB50\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.3,\n        \"features\": [\"2.1 channel\", \"300W output\", \"Wireless subwoofer\", \"Bluetooth\"],\n        \"description\": \"Upgrade your TV's audio with this sleek and powerful soundbar.\",\n        \"price\": 199.99\n    },\n    \"CineView OLED TV\": {\n        \"name\": \"CineView OLED TV\",\n        \"category\": \"Televisions and Home Theater Systems\",\n        \"brand\": \"CineView\",\n        \"model_number\": \"CV-OLED55\",\n        \"warranty\": \"2 years\",\n        \"rating\": 4.7,\n        \"features\": [\"55-inch display\", \"4K resolution\", \"HDR\", \"Smart TV\"],\n        \"description\": \"Experience true blacks and vibrant colors with this OLED TV.\",\n        \"price\": 1499.99\n    },\n\n    \"GameSphere X\": {\n        \"name\": \"GameSphere X\",\n        \"category\": \"Gaming Consoles and Accessories\",\n        \"brand\": \"GameSphere\",\n        \"model_number\": \"GS-X\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.9,\n        \"features\": [\"4K gaming\", \"1TB storage\", \"Backward compatibility\", \"Online multiplayer\"],\n        \"description\": \"A next-generation gaming console for the ultimate gaming experience.\",\n        \"price\": 499.99\n    },\n    \"ProGamer Controller\": {\n        \"name\": \"ProGamer Controller\",\n        \"category\": \"Gaming Consoles and Accessories\",\n        \"brand\": \"ProGamer\",\n        \"model_number\": \"PG-C100\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.2,\n        \"features\": [\"Ergonomic design\", \"Customizable buttons\", \"Wireless\", \"Rechargeable battery\"],\n        \"description\": \"A high-quality gaming controller for precision and comfort.\",\n        \"price\": 59.99\n    },\n    \"GameSphere Y\": {\n        \"name\": \"GameSphere Y\",\n        \"category\": \"Gaming Consoles and Accessories\",\n        \"brand\": \"GameSphere\",\n        \"model_number\": \"GS-Y\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.8,\n        \"features\": [\"4K gaming\", \"500GB storage\", \"Backward compatibility\", \"Online multiplayer\"],\n        \"description\": \"A compact gaming console with powerful performance.\",\n        \"price\": 399.99\n    },\n    \"ProGamer Racing Wheel\": {\n        \"name\": \"ProGamer Racing Wheel\",\n        \"category\": \"Gaming Consoles and Accessories\",\n        \"brand\": \"ProGamer\",\n        \"model_number\": \"PG-RW200\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.5,\n        \"features\": [\"Force feedback\", \"Adjustable pedals\", \"Paddle shifters\", \"Compatible with GameSphere X\"],\n        \"description\": \"Enhance your racing games with this realistic racing wheel.\",\n        \"price\": 249.99\n    },\n    \"GameSphere VR Headset\": {\n        \"name\": \"GameSphere VR Headset\",\n        \"category\": \"Gaming Consoles and Accessories\",\n        \"brand\": \"GameSphere\",\n        \"model_number\": \"GS-VR\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.6,\n        \"features\": [\"Immersive VR experience\", \"Built-in headphones\", \"Adjustable headband\", \"Compatible with GameSphere X\"],\n        \"description\": \"Step into the world of virtual reality with this comfortable VR headset.\",\n        \"price\": 299.99\n    },\n\n    \"AudioPhonic Noise-Canceling Headphones\": {\n        \"name\": \"AudioPhonic Noise-Canceling Headphones\",\n        \"category\": \"Audio Equipment\",\n        \"brand\": \"AudioPhonic\",\n        \"model_number\": \"AP-NC100\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.6,\n        \"features\": [\"Active noise-canceling\", \"Bluetooth\", \"20-hour battery life\", \"Comfortable fit\"],\n        \"description\": \"Experience immersive sound with these noise-canceling headphones.\",\n        \"price\": 199.99\n    },\n    \"WaveSound Bluetooth Speaker\": {\n        \"name\": \"WaveSound Bluetooth Speaker\",\n        \"category\": \"Audio Equipment\",\n        \"brand\": \"WaveSound\",\n        \"model_number\": \"WS-BS50\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.5,\n        \"features\": [\"Portable\", \"10-hour battery life\", \"Water-resistant\", \"Built-in microphone\"],\n        \"description\": \"A compact and versatile Bluetooth speaker for music on the go.\",\n        \"price\": 49.99\n    },\n    \"AudioPhonic True Wireless Earbuds\": {\n        \"name\": \"AudioPhonic True Wireless Earbuds\",\n        \"category\": \"Audio Equipment\",\n        \"brand\": \"AudioPhonic\",\n        \"model_number\": \"AP-TW20\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.4,\n        \"features\": [\"True wireless\", \"Bluetooth 5.0\", \"Touch controls\", \"18-hour battery life\"],\n        \"description\": \"Enjoy music without wires with these comfortable true wireless earbuds.\",\n        \"price\": 79.99\n    },\n    \"WaveSound Soundbar\": {\n        \"name\": \"WaveSound Soundbar\",\n        \"category\": \"Audio Equipment\",\n        \"brand\": \"WaveSound\",\n        \"model_number\": \"WS-SB40\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.3,\n        \"features\": [\"2.0 channel\", \"80W output\", \"Bluetooth\", \"Wall-mountable\"],\n        \"description\": \"Upgrade your TV's audio with this slim and powerful soundbar.\",\n        \"price\": 99.99\n    },\n    \"AudioPhonic Turntable\": {\n        \"name\": \"AudioPhonic Turntable\",\n        \"category\": \"Audio Equipment\",\n        \"brand\": \"AudioPhonic\",\n        \"model_number\": \"AP-TT10\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.2,\n        \"features\": [\"3-speed\", \"Built-in speakers\", \"Bluetooth\", \"USB recording\"],\n        \"description\": \"Rediscover your vinyl collection with this modern turntable.\",\n        \"price\": 149.99\n    },\n\n    \"FotoSnap DSLR Camera\": {\n        \"name\": \"FotoSnap DSLR Camera\",\n        \"category\": \"Cameras and Camcorders\",\n        \"brand\": \"FotoSnap\",\n        \"model_number\": \"FS-DSLR200\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.7,\n        \"features\": [\"24.2MP sensor\", \"1080p video\", \"3-inch LCD\", \"Interchangeable lenses\"],\n        \"description\": \"Capture stunning photos and videos with this versatile DSLR camera.\",\n        \"price\": 599.99\n    },\n    \"ActionCam 4K\": {\n        \"name\": \"ActionCam 4K\",\n        \"category\": \"Cameras and Camcorders\",\n        \"brand\": \"ActionCam\",\n        \"model_number\": \"AC-4K\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.4,\n        \"features\": [\"4K video\", \"Waterproof\", \"Image stabilization\", \"Wi-Fi\"],\n        \"description\": \"Record your adventures with this rugged and compact 4K action camera.\",\n        \"price\": 299.99\n    },\n    \"FotoSnap Mirrorless Camera\": {\n        \"name\": \"FotoSnap Mirrorless Camera\",\n        \"category\": \"Cameras and Camcorders\",\n        \"brand\": \"FotoSnap\",\n        \"model_number\": \"FS-ML100\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.6,\n        \"features\": [\"20.1MP sensor\", \"4K video\", \"3-inch touchscreen\", \"Interchangeable lenses\"],\n        \"description\": \"A compact and lightweight mirrorless camera with advanced features.\",\n        \"price\": 799.99\n    },\n    \"ZoomMaster Camcorder\": {\n        \"name\": \"ZoomMaster Camcorder\",\n        \"category\": \"Cameras and Camcorders\",\n        \"brand\": \"ZoomMaster\",\n        \"model_number\": \"ZM-CM50\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.3,\n        \"features\": [\"1080p video\", \"30x optical zoom\", \"3-inch LCD\", \"Image stabilization\"],\n        \"description\": \"Capture life's moments with this easy-to-use camcorder.\",\n        \"price\": 249.99\n    },\n    \"FotoSnap Instant Camera\": {\n        \"name\": \"FotoSnap Instant Camera\",\n        \"category\": \"Cameras and Camcorders\",\n        \"brand\": \"FotoSnap\",\n        \"model_number\": \"FS-IC10\",\n        \"warranty\": \"1 year\",\n        \"rating\": 4.1,\n        \"features\": [\"Instant prints\", \"Built-in flash\", \"Selfie mirror\", \"Battery-powered\"],\n        \"description\": \"Create instant memories with this fun and portable instant camera.\",\n        \"price\": 69.99\n    }\n}\n```\n:::\n\n\n## Helper function: get product by name {.smaller}\n\n::: {#e6ce5bf4 .cell execution_count=11}\n``` {.python .cell-code}\ndef get_product_by_name(name):\n    return products.get(name, None)\n```\n:::\n\n\n. . .\n\n::: {#258707cd .cell output-location='fragment' execution_count=12}\n``` {.python .cell-code}\nprint(get_product_by_name(\"TechPro Ultrabook\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{'name': 'TechPro Ultrabook', 'category': 'Computers and Laptops', 'brand': 'TechPro', 'model_number': 'TP-UB100', 'warranty': '1 year', 'rating': 4.5, 'features': ['13.3-inch display', '8GB RAM', '256GB SSD', 'Intel Core i5 processor'], 'description': 'A sleek and lightweight ultrabook for everyday use.', 'price': 799.99}\n```\n:::\n:::\n\n\n## Helper function: get product by category {.smaller}\n\n::: {#6074385e .cell execution_count=13}\n``` {.python .cell-code}\ndef get_products_by_category(category):\n    return [product for product in products.values() if product[\"category\"] == category]\n\n```\n:::\n\n\n. . .\n\n::: {#c0693c10 .cell output-location='fragment' execution_count=14}\n``` {.python .cell-code}\nprint(get_products_by_category(\"Computers and Laptops\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[{'name': 'TechPro Ultrabook', 'category': 'Computers and Laptops', 'brand': 'TechPro', 'model_number': 'TP-UB100', 'warranty': '1 year', 'rating': 4.5, 'features': ['13.3-inch display', '8GB RAM', '256GB SSD', 'Intel Core i5 processor'], 'description': 'A sleek and lightweight ultrabook for everyday use.', 'price': 799.99}, {'name': 'BlueWave Gaming Laptop', 'category': 'Computers and Laptops', 'brand': 'BlueWave', 'model_number': 'BW-GL200', 'warranty': '2 years', 'rating': 4.7, 'features': ['15.6-inch display', '16GB RAM', '512GB SSD', 'NVIDIA GeForce RTX 3060'], 'description': 'A high-performance gaming laptop for an immersive experience.', 'price': 1199.99}, {'name': 'PowerLite Convertible', 'category': 'Computers and Laptops', 'brand': 'PowerLite', 'model_number': 'PL-CV300', 'warranty': '1 year', 'rating': 4.3, 'features': ['14-inch touchscreen', '8GB RAM', '256GB SSD', '360-degree hinge'], 'description': 'A versatile convertible laptop with a responsive touchscreen.', 'price': 699.99}, {'name': 'TechPro Desktop', 'category': 'Computers and Laptops', 'brand': 'TechPro', 'model_number': 'TP-DT500', 'warranty': '1 year', 'rating': 4.4, 'features': ['Intel Core i7 processor', '16GB RAM', '1TB HDD', 'NVIDIA GeForce GTX 1660'], 'description': 'A powerful desktop computer for work and play.', 'price': 999.99}, {'name': 'BlueWave Chromebook', 'category': 'Computers and Laptops', 'brand': 'BlueWave', 'model_number': 'BW-CB100', 'warranty': '1 year', 'rating': 4.1, 'features': ['11.6-inch display', '4GB RAM', '32GB eMMC', 'Chrome OS'], 'description': 'A compact and affordable Chromebook for everyday tasks.', 'price': 249.99}]\n```\n:::\n:::\n\n\n## Category and product response 1\n\n::: {#accfda22 .cell output-location='fragment' execution_count=15}\n``` {.python .cell-code}\nprint(user_message_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n tell me about the smartx pro phone and  the fotosnap camera, the dslr one.  Also tell me about your tvs \n```\n:::\n:::\n\n\n. . .\n\n::: {#a7710536 .cell output-location='slide' execution_count=16}\n``` {.python .cell-code}\nprint(category_and_product_response_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[{'category': 'Smartphones and Accessories'}, {'category': 'Cameras and Camcorders'}, {'category': 'Televisions and Home Theater Systems'}]\n```\n:::\n:::\n\n\n## Helper function: String into dictionaries {.smaller}\n\nRead Python string into Python list of dictionaries\n\n::: {#dd10d278 .cell execution_count=17}\n``` {.python .cell-code}\ndef read_string_to_list(input_string):\n    if input_string is None:\n        return None\n\n    try:\n        # Replace single quotes with double quotes for valid JSON\n        input_string = input_string.replace(\"'\", \"\\\"\")\n        data = json.loads(input_string)\n        return data\n    except json.JSONDecodeError:\n        print(\"Error: Invalid JSON string\")\n        return None\n\n```\n:::\n\n\n## Category and product list\n\n::: {#b358119c .cell output-location='fragment' execution_count=18}\n``` {.python .cell-code}\ncategory_and_product_list = read_string_to_list(\n    category_and_product_response_1)\nprint(category_and_product_list)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[{'category': 'Smartphones and Accessories'}, {'category': 'Cameras and Camcorders'}, {'category': 'Televisions and Home Theater Systems'}]\n```\n:::\n:::\n\n\n## Helper function: Generate output string\n\nRetrieve detailed product information for the relevant products and categories\n\n::: {#c617817c .cell execution_count=19}\n``` {.python .cell-code}\ndef generate_output_string(data_list):\n    output_string = \"\"\n\n    if data_list is None:\n        return output_string\n\n    for data in data_list:\n        try:\n            if \"products\" in data:\n                products_list = data[\"products\"]\n                for product_name in products_list:\n                    product = get_product_by_name(product_name)\n                    if product:\n                        output_string += json.dumps(product, indent=4) + \"\\n\"\n                    else:\n                        print(f\"Error: Product '{product_name}' not found\")\n            elif \"category\" in data:\n                category_name = data[\"category\"]\n                category_products = get_products_by_category(category_name)\n                for product in category_products:\n                    output_string += json.dumps(product, indent=4) + \"\\n\"\n            else:\n                print(\"Error: Invalid object format\")\n        except Exception as e:\n            print(f\"Error: {e}\")\n\n    return output_string\n\n```\n:::\n\n\n## Product info for user message 1\n\n::: {#e2397aba .cell output-location='slide' execution_count=20}\n``` {.python .cell-code}\nproduct_information_for_user_message_1 = generate_output_string(\n    category_and_product_list)\nprint(product_information_for_user_message_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{\n    \"name\": \"SmartX ProPhone\",\n    \"category\": \"Smartphones and Accessories\",\n    \"brand\": \"SmartX\",\n    \"model_number\": \"SX-PP10\",\n    \"warranty\": \"1 year\",\n    \"rating\": 4.6,\n    \"features\": [\n        \"6.1-inch display\",\n        \"128GB storage\",\n        \"12MP dual camera\",\n        \"5G\"\n    ],\n    \"description\": \"A powerful smartphone with advanced camera features.\",\n    \"price\": 899.99\n}\n{\n    \"name\": \"MobiTech PowerCase\",\n    \"category\": \"Smartphones and Accessories\",\n    \"brand\": \"MobiTech\",\n    \"model_number\": \"MT-PC20\",\n    \"warranty\": \"1 year\",\n    \"rating\": 4.3,\n    \"features\": [\n        \"5000mAh battery\",\n        \"Wireless charging\",\n        \"Compatible with SmartX ProPhone\"\n    ],\n    \"description\": \"A protective case with built-in battery for extended usage.\",\n    \"price\": 59.99\n}\n{\n    \"name\": \"SmartX MiniPhone\",\n    \"category\": \"Smartphones and Accessories\",\n    \"brand\": \"SmartX\",\n    \"model_number\": \"SX-MP5\",\n    \"warranty\": \"1 year\",\n    \"rating\": 4.2,\n    \"features\": [\n        \"4.7-inch display\",\n        \"64GB storage\",\n        \"8MP camera\",\n        \"4G\"\n    ],\n    \"description\": \"A compact and affordable smartphone for basic tasks.\",\n    \"price\": 399.99\n}\n{\n    \"name\": \"MobiTech Wireless Charger\",\n    \"category\": \"Smartphones and Accessories\",\n    \"brand\": \"MobiTech\",\n    \"model_number\": \"MT-WC10\",\n    \"warranty\": \"1 year\",\n    \"rating\": 4.5,\n    \"features\": [\n        \"10W fast charging\",\n        \"Qi-compatible\",\n        \"LED indicator\",\n        \"Compact design\"\n    ],\n    \"description\": \"A convenient wireless charger for a clutter-free workspace.\",\n    \"price\": 29.99\n}\n{\n    \"name\": \"SmartX EarBuds\",\n    \"category\": \"Smartphones and Accessories\",\n    \"brand\": \"SmartX\",\n    \"model_number\": \"SX-EB20\",\n    \"warranty\": \"1 year\",\n    \"rating\": 4.4,\n    \"features\": [\n        \"True wireless\",\n        \"Bluetooth 5.0\",\n        \"Touch controls\",\n        \"24-hour battery life\"\n    ],\n    \"description\": \"Experience true wireless freedom with these comfortable earbuds.\",\n    \"price\": 99.99\n}\n{\n    \"name\": \"FotoSnap DSLR Camera\",\n    \"category\": \"Cameras and Camcorders\",\n    \"brand\": \"FotoSnap\",\n    \"model_number\": \"FS-DSLR200\",\n    \"warranty\": \"1 year\",\n    \"rating\": 4.7,\n    \"features\": [\n        \"24.2MP sensor\",\n        \"1080p video\",\n        \"3-inch LCD\",\n        \"Interchangeable lenses\"\n    ],\n    \"description\": \"Capture stunning photos and videos with this versatile DSLR camera.\",\n    \"price\": 599.99\n}\n{\n    \"name\": \"ActionCam 4K\",\n    \"category\": \"Cameras and Camcorders\",\n    \"brand\": \"ActionCam\",\n    \"model_number\": \"AC-4K\",\n    \"warranty\": \"1 year\",\n    \"rating\": 4.4,\n    \"features\": [\n        \"4K video\",\n        \"Waterproof\",\n        \"Image stabilization\",\n        \"Wi-Fi\"\n    ],\n    \"description\": \"Record your adventures with this rugged and compact 4K action camera.\",\n    \"price\": 299.99\n}\n{\n    \"name\": \"FotoSnap Mirrorless Camera\",\n    \"category\": \"Cameras and Camcorders\",\n    \"brand\": \"FotoSnap\",\n    \"model_number\": \"FS-ML100\",\n    \"warranty\": \"1 year\",\n    \"rating\": 4.6,\n    \"features\": [\n        \"20.1MP sensor\",\n        \"4K video\",\n        \"3-inch touchscreen\",\n        \"Interchangeable lenses\"\n    ],\n    \"description\": \"A compact and lightweight mirrorless camera with advanced features.\",\n    \"price\": 799.99\n}\n{\n    \"name\": \"ZoomMaster Camcorder\",\n    \"category\": \"Cameras and Camcorders\",\n    \"brand\": \"ZoomMaster\",\n    \"model_number\": \"ZM-CM50\",\n    \"warranty\": \"1 year\",\n    \"rating\": 4.3,\n    \"features\": [\n        \"1080p video\",\n        \"30x optical zoom\",\n        \"3-inch LCD\",\n        \"Image stabilization\"\n    ],\n    \"description\": \"Capture life's moments with this easy-to-use camcorder.\",\n    \"price\": 249.99\n}\n{\n    \"name\": \"FotoSnap Instant Camera\",\n    \"category\": \"Cameras and Camcorders\",\n    \"brand\": \"FotoSnap\",\n    \"model_number\": \"FS-IC10\",\n    \"warranty\": \"1 year\",\n    \"rating\": 4.1,\n    \"features\": [\n        \"Instant prints\",\n        \"Built-in flash\",\n        \"Selfie mirror\",\n        \"Battery-powered\"\n    ],\n    \"description\": \"Create instant memories with this fun and portable instant camera.\",\n    \"price\": 69.99\n}\n{\n    \"name\": \"CineView 4K TV\",\n    \"category\": \"Televisions and Home Theater Systems\",\n    \"brand\": \"CineView\",\n    \"model_number\": \"CV-4K55\",\n    \"warranty\": \"2 years\",\n    \"rating\": 4.8,\n    \"features\": [\n        \"55-inch display\",\n        \"4K resolution\",\n        \"HDR\",\n        \"Smart TV\"\n    ],\n    \"description\": \"A stunning 4K TV with vibrant colors and smart features.\",\n    \"price\": 599.99\n}\n{\n    \"name\": \"SoundMax Home Theater\",\n    \"category\": \"Televisions and Home Theater Systems\",\n    \"brand\": \"SoundMax\",\n    \"model_number\": \"SM-HT100\",\n    \"warranty\": \"1 year\",\n    \"rating\": 4.4,\n    \"features\": [\n        \"5.1 channel\",\n        \"1000W output\",\n        \"Wireless subwoofer\",\n        \"Bluetooth\"\n    ],\n    \"description\": \"A powerful home theater system for an immersive audio experience.\",\n    \"price\": 399.99\n}\n{\n    \"name\": \"CineView 8K TV\",\n    \"category\": \"Televisions and Home Theater Systems\",\n    \"brand\": \"CineView\",\n    \"model_number\": \"CV-8K65\",\n    \"warranty\": \"2 years\",\n    \"rating\": 4.9,\n    \"features\": [\n        \"65-inch display\",\n        \"8K resolution\",\n        \"HDR\",\n        \"Smart TV\"\n    ],\n    \"description\": \"Experience the future of television with this stunning 8K TV.\",\n    \"price\": 2999.99\n}\n{\n    \"name\": \"SoundMax Soundbar\",\n    \"category\": \"Televisions and Home Theater Systems\",\n    \"brand\": \"SoundMax\",\n    \"model_number\": \"SM-SB50\",\n    \"warranty\": \"1 year\",\n    \"rating\": 4.3,\n    \"features\": [\n        \"2.1 channel\",\n        \"300W output\",\n        \"Wireless subwoofer\",\n        \"Bluetooth\"\n    ],\n    \"description\": \"Upgrade your TV's audio with this sleek and powerful soundbar.\",\n    \"price\": 199.99\n}\n{\n    \"name\": \"CineView OLED TV\",\n    \"category\": \"Televisions and Home Theater Systems\",\n    \"brand\": \"CineView\",\n    \"model_number\": \"CV-OLED55\",\n    \"warranty\": \"2 years\",\n    \"rating\": 4.7,\n    \"features\": [\n        \"55-inch display\",\n        \"4K resolution\",\n        \"HDR\",\n        \"Smart TV\"\n    ],\n    \"description\": \"Experience true blacks and vibrant colors with this OLED TV.\",\n    \"price\": 1499.99\n}\n\n```\n:::\n:::\n\n\n# Answer with detailed product information\n\nGenerate answer to user query based on detailed product information\n\n\n## System message\n\n::: {#cf5f3f28 .cell execution_count=21}\n``` {.python .cell-code}\nsystem_message = f\"\"\"\nYou are a customer service assistant for a \\\nlarge electronic store. \\\nRespond in a friendly and helpful tone, \\\nwith very concise answers. \\\nMake sure to ask the user relevant follow up questions.\n\"\"\"\n```\n:::\n\n\n## User message 1\n\n::: {#f39ac203 .cell execution_count=22}\n``` {.python .cell-code}\nuser_message_1 = f\"\"\"\ntell me about the smartx pro phone and \\\nthe fotosnap camera, the dslr one. \\\nAlso tell me about your tvs\"\"\"\n```\n:::\n\n\n## Messages \n\n::: {#20f196c5 .cell execution_count=23}\n``` {.python .cell-code}\nmessages = [\n    {'role': 'system',\n     'content': system_message},\n    {'role': 'user',\n     'content': user_message_1},\n    {'role': 'assistant',\n     'content': f\"\"\"Relevant product information:\\n\\\n {product_information_for_user_message_1}\"\"\"},\n]\n```\n:::\n\n\n## Response\n\n::: {#bc5e4cd2 .cell output-location='slide' execution_count=24}\n``` {.python .cell-code}\nfinal_response = get_completion_from_messages(messages)\nprint(final_response)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThe SmartX ProPhone is a powerful smartphone with a 6.1-inch display, 128GB storage, a 12MP dual camera, and 5G capability. It is priced at $899.99. Is there anything specific you would like to know about the SmartX ProPhone?\n\nThe FotoSnap DSLR Camera is a versatile camera with a 24.2MP sensor, 1080p video recording, a 3-inch LCD, and interchangeable lenses. It is priced at $599.99. Is there anything specific you would like to know about the FotoSnap DSLR Camera?\n\nWe have a wide range of TVs available. Can you please specify if you are interested in a particular brand, size, or feature?\n```\n:::\n:::\n\n\n# What's next? {background-image=\"../images/logo.png\" background-opacity=\"0.5\"}\n\n- **Congratulations! You have completed this tutorial** üëç\n\n- **Next, you may want to go back to the [lab's website](https://kirenz.github.io/lab-chat-system/)**\n\n",
    "supporting": [
      "chaining_files"
    ],
    "filters": [],
    "includes": {}
  }
}